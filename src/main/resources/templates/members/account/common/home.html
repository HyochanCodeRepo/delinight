<!DOCTYPE html>
<html lang="ko"
      xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{layout/desktop/layout}"
>
<head>
    <title>델리나잇</title>

    <!--별도 css 필요할 시 아래로 추가-->
    <!--어디서 그대로 가져오는거 아니면 클래스 이름 잘 붙여주고
    styles.css에 작성할것-->
</head>

<body>
<!--이 줄 div layout:fragment명과 id명 절대 수정 금지!!!!-->
<div layout:fragment="adminContent" id="layoutSidenav_content">
    <main>
        <div class="container-fluid px-5">
            <!--작업 영역-->
            <!--반드시 이 안에서만 작업-->

            <!--페이지 제목 명명-->
            <h3 class="mt-5">관리자 홈</h3>
            <ol class="breadcrumb mb-4">
                <!--페이지 소제목 명명-->
                <a href="#" class="breadcrumb-item active no-click" th:text="'환영합니다, '+${member.name}+' 님'"></a>
            </ol>

            <!--기본 카드 양식-->
            <div class="d-flex gap-3" style="margin-bottom: -0.5rem;">
                <div class="card custom-shadow mb-4 card-flex-50" >
                    <div class="card-body">
                        <!--카드 제목-->
                        <h5 class="mb-4 fw-bold">문의사항 목록</h5>

                        <table class="table table-striped">
                            <thead>
                            <tr>
                                <th>글번호</th>
                                <th>제목</th>
                                <th>내용</th>
                                <th>요청시간</th>
                                <th>답변시간</th>
                            </tr>
                            </thead>
                            <th:block th:each="inquireDTO: ${inquireDTOList}">
                                <tr>
                                    <td>
                                        <a th:href="@{/members/inquire/read(id=${inquireDTO.id})}">
                                            [[${inquireDTO.id}]]
                                        </a>
                                    </td>
                                    <td th:text="${inquireDTO.title}"></td>
                                    <td th:text="${inquireDTO.content}"></td>
                                    <td th:text="${#temporals.format(inquireDTO.regTime,'yy/MM/dd/ HH:mm')}"></td>
                                    <td th:text="${#temporals.format(inquireDTO.responseTime,'yy/MM/dd/ HH:mm')}"></td>
                                </tr>
                            </th:block>


                        </table>



                    </div>
                </div>
                <div class="card custom-shadow mb-4 card-flex-50">
                    <div class="card-body">
                        <!--카드 제목-->
                        <h5 class="mb-4 fw-bold">계정 관리 리스트</h5>
                        <table class="table align-middle">

                            <thead>
                            <th scope="col">#</th>
                            <th scope="col">이름</th>
                            <th scope="col">이메일</th>
                            <th scope="col">핸드폰번호</th>
                            <th scope="col">권한</th>
                            <th scope="col">처리여부</th>
                            <th scope="col">승인여부</th>
                            </thead>

                            <tbody>
                            <th:block  th:each="list:${paging}">
                                <tr>
                                    <th scope="row offset-4" th:text="${list.id}"></th>
                                    <td><a th:data-num="${list.id}" th:href="@{/board/read(id=${list.id})}">
                                        [[${list.name}]]
                                    </a>
                                    </td>
                                    <td th:text="${list.email}"></td>
                                    <td th:text="${list.phone}"></td>


                                    <td th:text="${list.role}"></td>

                                    <td th:if="${list.status.name() == 'WAIT'}" class="text-danger fw-bold">대기중</td>
                                    <td th:if="${list.status.name() == 'VALID' or list.status.name() == 'NOTVALID'}" class="text-secondary">처리됨</td>

                                    <td th:if="${list.status.name() == 'WAIT'}" class="d-flex">
                                        <button class="btn btn-primary" th:value="${list.id}" id="approveBtn">승인</button>
                                        <button class="btn btn-gray offset-0" th:value="${list.id}" id="DisapproveBtn">반려</button>
                                    </td>

                                    <td th:if="${list.status.name() == 'VALID'}" class="text-primary" th:text="승인완료"></td>
                                    <td th:if="${list.status.name() == 'NOTVALID'}" class="text-danger" th:text="반려"></td>
                                </tr>
                            </th:block>

                            </tbody>

                        </table>




                    </div>
                </div>
            </div>

            <div class="card custom-shadow mb-4">
                <div class="card-body">
                    <!--카드 제목-->
                    <h5 class="mb-4 fw-bold">정산차트</h5>
                    <div class="d-flex gap-3" >
                        <div class="row">
                            <div class="col-md-6">
                                <div class="card custom-shadow mb-4">
                                    <div class="card-header">정산 테이블</div>
                                    <div class="card-body">
                                        <table id="payInfo" class="table table-striped table-bordered mb-4">
                                            <thead class="table-light">
                                            <tr>
                                                <th onclick="sortTable(0)">결제 ID</th>
                                                <th onclick="sortTable(1)">결제 항목</th>
                                                <th onclick="sortTable(2)">정산여부</th>
                                                <th onclick="sortTable(3)">결제일</th>
                                                <th onclick="sortTable(4)">금액</th>
                                                <th onclick="sortTable(5)">부가세</th>
                                                <th onclick="sortTable(6)">합계금액</th>
                                            </tr>
                                            </thead>
                                            <tbody>

                                            </tbody>
                                        </table>
                                        <!-- 메뉴 관련 테이블을 추가하려면 동일한 테이블 내에서 메뉴 항목들을 추가합니다 -->
                                        <table id="menuInfo" class="table table-striped table-bordered mb-4" style="display:none;">
                                            <thead class="table-light">
                                            <tr>
                                                <th>메뉴 이름</th>
                                                <th>가격</th>
                                                <th>수량</th>
                                                <th>총 금액</th>
                                            </tr>
                                            </thead>
                                            <tbody id="menuInfoBody">

                                            </tbody>
                                        </table>

                                        <div class="mt-4 ps-2">
                                            <h5>총 금액: <span id="totalPriceSum" class="text-primary">0</span> 원</h5>
                                            <h5>부가세 합계: <span id="totalVat" class="text-warning">0</span> 원</h5>
                                            <h5>부가세 포함 최종 금액: <span id="totalVatSum" class="text-success">0</span> 원</h5>
                                        </div>

                                    </div>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="card custom-shadow mb-4">
                                    <div class="card-header">정산 차트</div>
                                    <div class="card-body">
                                        <!-- 차트를 보여줄 캔버스 요소 -->
                                        <canvas id="dynamicChart" width="400" height="200"></canvas>

                                        <!-- 각 차트별로 보이도록 할 div 영역 (선택적으로 사용) -->
                                        <div id="paymentChart" style="display: none;">
                                            <canvas id="paymentCanvas" width="400" height="200"></canvas>
                                        </div>
                                        <div id="orderChart" style="display: none;">
                                            <canvas id="orderCanvas" width="400" height="200"></canvas>
                                        </div>
                                        <div id="menuChart" style="display: none;">
                                            <canvas id="menuCanvas" width="400" height="200"></canvas>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                    </div>

                </div>
            </div>
        </div>
    </main>

    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>

    <!--푸터 절대 수정 금지!!!!-->
    <!--푸터-->
    <div th:replace="~{fragments/desktop/adminfooter::adminFooter}"></div>
</div>
</body>
</html>
