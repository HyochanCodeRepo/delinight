<!DOCTYPE html>
<html lang="ko"
      xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{layout/desktop/layout}"
>
<head>
    <style>
        .search {
            max-width: 350px;
            height: 100%;
            outline: none;
            font-size: 14px;
            font-weight: 500;
            caret-color: #2b2b2b;
            color: black;
            padding: 7px 10px;
            border: 1.5px solid black;
            border-top-left-radius: 7px;
            border-bottom-left-radius: 7px;
            margin-right: 1px;
            transition: all .2s ease;
        }

        .search__btn {
            border: none;
            cursor: pointer;
            background-color: rgba(42, 42, 45, 1);
            border-top-right-radius: 7px;
            border-bottom-right-radius: 7px;
            height: 100%;
            width: 30px;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        .search__btn:hover {
            background-color: rgba(54, 54, 56, 1);
        }
    </style>

    <title>델리나잇</title>
</head>

<body>
<!--이 줄 div layout:fragment명과 id명 절대 수정 금지!!!!-->
<div layout:fragment="adminContent" id="layoutSidenav_content">
    <main>
        <!--내용 넣는 곳-->
        <div class="container-fluid px-5">
            <div class="card custom-shadow mb-4 mt-5">
                <div class="card-body">
                    <h3>새 본사 등록</h3>
                    <ol class="breadcrumb mb-5">
                        <a href="/members/account/home" class="breadcrumb-item active">홈</a>
                        <a href="#" class="breadcrumb-item active no-click">본사 관리</a>
                    </ol>

                    <form action="/members/center/create" th:field="${centerDTO}" method="post" enctype="multipart/form-data">
                        <div class="centerFormData"></div>
                        <div class="container">
                            <div class="row">

                                <div class="col-6">


                                    <div class="md-3  mb-3">
                                        <label for="name" class="form-label">본사명</label>
                                        <input type="text" class="form-control" id="name" name="name">
                                        <div class="text-sm mt-1 text-danger" th:if="${nameError != null}" th:text="${nameError}"></div>
                                    </div>

                                    <div class="row mb-3">
                                        <label for="content" class="col-sm-3 col-form-label form-label">설명</label>
                                        <div class="col-sm-8">
                                            <textarea type="text" class="form-control" id="content" name="content"></textarea>
                                            <div class="text-sm mt-1 text-danger" th:if="${contentError != null}" th:text="${contentError}"></div>
                                        </div>
                                    </div>
                                </div>

                                <div class="w-50">
                                    <div class="row mb-3">
                                        <label for="name" class="col-sm-3 col-form-label form-label">관리자 등록</label>
                                        <div class="col-sm-8 d-flex">
                                            <input type="text" name="text" class="search"
                                                   placeholder="담당자 이메일을 입력해주세요." style="width: 350px">
                                            <button class="search__btn px-4" type="button">
                                                <i class="fas fa-magnifying-glass text-white"></i>
                                            </button>
                                        </div>

                                    </div>
                                    <div class="row mb-3">
                                        <label for="name" class="col-sm-3 col-form-label form-label">검색 결과</label>
                                        <div class="col-sm-8">
                                            <table>
                                                <th class="w-75"></th>
                                                <th class="w-25"></th>
                                                <tbody class="tBody">

                                                </tbody>
                                            </table>
                                        </div>
                                    </div>

                            </div>
                        </div>
                        <div class="text-center mt-5">
                            <button type="submit" class="btn btn-primary">등록</button>
                            <a href="/members/account/superAdHome" class="btn btn-gray">취소</a>
                        </div>
                    </form>

                </div>

            </div>



            <script type="text/javascript" src="/js/imgscript.js"></script>
            <script th:inline="javascript">

                $(document).on("click", ".addMembers", function () {
                    let membersId = $(this).data("membersid")
                    $(".centerFormData").empty();
                    $(".centerFormData").append("<input type='hidden' name='membersId' value='" + membersId + "'>")
                    Swal.fire({
                        icon: 'success',
                        title: '추가 완료',
                        text: '본사 관리자가 추가 되었습니다.',
                    });
                })
                $(".search__btn").on("click", function () {
                    $(".tBody").empty();
                    let email = $(".search").val()
                    $.ajax({
                        type: "get",
                        url: "/rest/searchMembers",
                        data: {"email": email},
                        success: function (result) {
                            if (result.email !== "ghost") {
                                let str = "<tr><td class='me-5'>" + result.email + "</td><td><button class='addMembers btn btn-outline-primary text-center' type='button' data-membersid='" + result.id + "'>등록 +</button></td></tr>"
                                $(".tBody").html(str)
                            }

                        }

                    })
                })
            </script>


        </div>
    </main>
    <div th:replace="~{fragments/desktop/adminfooter::adminFooter}"></div>


</div>

</body>
</html>